export type Severity = 'critical' | 'high' | 'medium' | 'low' | 'negligible';

export type KaiStatus = 'invalid - norisk' | 'ai-invalid-norisk' | string;

export interface RiskFactor {
  [key: string]: Record<string, never>;
}

export interface Vulnerability {
  cve: string;
  severity: Severity;
  cvss: number;
  status: string;
  kaiStatus?: KaiStatus;
  cause: string;
  description: string;
  vecStr: string;
  exploit: string;
  riskFactors: RiskFactor;
  link: string;
  type: string;
  packageName: string;
  packageVersion: string;
  packageType: string;
  layerTime: string;
  published: string;
  fixDate: string;
  applicableRules: string[];
  owner: string;
  advisoryType: string;
  path: string;
}

export interface Image {
  name: string;
  version: string;
  baseImage: string;
  buildType: string;
  maintainer: string;
  createTime: string;
  vulnerabilities: Vulnerability[];
}

export interface ImageMap {
  [version: string]: Image;
}

export interface Repo {
  name: string;
  images: ImageMap;
}

export interface RepoMap {
  [repoName: string]: Repo;
}

export interface Group {
  name: string;
  repos: RepoMap;
}

export interface GroupMap {
  [groupName: string]: Group;
}

export interface VulnerabilityData {
  name: string;
  groups: GroupMap;
}

export interface ProcessedVulnerability extends Vulnerability {
  id: string; // Unique identifier
  groupName: string;
  repoName: string;
  imageName: string;
  imageVersion: string;
}

export interface DashboardStats {
  totalVulnerabilities: number;
  criticalCount: number;
  highCount: number;
  mediumCount: number;
  lowCount: number;
  negligibleCount: number;
  withFix: number;
  withoutFix: number;
  aiInvalidNorisk: number;
  invalidNorisk: number;
  uniquePackages: number;
  uniqueCVEs: number;
  // Status counts
  statusFixed: number;
  statusAffected: number;
  statusOpen: number;
  statusUnderInvestigation: number;
  statusNoStatus: number;
  statusWillNotFix: number;
  statusNeeded: number;
  statusDeferred: number;
}

export type VulnerabilityStatus =
  | 'Fixed'
  | 'Affected'
  | 'Open'
  | 'Under Investigation'
  | 'No Status'
  | 'Will Not Fix'
  | 'Needed'
  | 'Deferred';

export interface FilterState {
  severity: Severity[];
  kaiStatus: KaiStatus[];
  packageType: string[];
  riskFactors: string[];
  searchQuery: string;
  status: VulnerabilityStatus[];
  dateRange: {
    start: string | null;
    end: string | null;
  };
}

export interface AnalysisMode {
  mode: 'all' | 'analysis' | 'ai-analysis';
  label: string;
  filterToKaiStatus: KaiStatus[] | null; // null means show all
}
